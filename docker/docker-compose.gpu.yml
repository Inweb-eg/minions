# Minions Framework - GPU Support Override
# =========================================
#
# Use with NVIDIA GPUs for accelerated AI inference
#
# Requires:
#   - NVIDIA GPU
#   - nvidia-container-toolkit installed
#   - NVIDIA driver 525.60.13 or later
#
# Usage:
#   docker-compose -f docker-compose.yml -f docker-compose.gpu.yml up -d

version: '3.8'

services:
  minions:
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility

  minions-dev:
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility

  ollama:
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
